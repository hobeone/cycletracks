{% extends "base.html" %}
{% load extra_filters %}

{% block title %}CycleTracks Dashboard{% endblock %}

{% block extra_head %}
<script type="text/javascript">
  function delete_activity(id) {
    if (confirm('Are you sure?'))
    {
    $.ajax({
        url: '/activity/delete/',
        type: 'POST',
        timeout: 4000,
        data: {'activity_id':id},
        error: function(XMLHttpRequest, textStatus, errorThrown) {
          alert('Error Deleting Activity ' + id +': ' + textStatus)
        },
        success: function(response){
          $('#activity_'+id).fadeOut(500)
        }
    });
    }
  };
</script>
{% endblock %}

{% block content %}
<div id="activity_table">
  <div id="userSummary">
    <div id="summaryTitle">Summary for {{user.username}}:</div>
    <div id="userSummaryContent">
      <div class="summaryGroup">
        <div class="userSummaryItem">
          <span class="summaryLabel">Total Distance:</span>
          <span class="summaryField">{{ user_totals.total_meters|meters_to_prefered_distance:user.get_profile.use_imperial }} {{user.get_profile.use_imperial|miles_or_km_units}}</span>
        </div>
        <div class="userSummaryItem">
          <span class="summaryLabel">Total Climbing:</span>
          <span class="summaryField">{{ user_totals.total_ascent|meters_to_prefered_distance:user.get_profile.use_imperial }} {{user.get_profile.use_imperial|miles_or_km_units}}</span>
        </div>
        <div class="userSummaryItem">
          <span class="summaryLabel">Total Time:</span>
          <span class="summaryField">{{ user_totals.total_time|seconds_to_human_readable }}</span>
        </div>

      </div>
      <div class="summaryGroup">

        <div class="userSummaryItem">
          <span class="summaryLabel">Rolling Time:</span>
          <span class="summaryField">{{ user_totals.rolling_time|seconds_to_human_readable }}</span>
        </div>
        <div class="userSummaryItem">
          <span class="summaryLabel">Cadence:</span>
          <span class="summaryField">{{ user_totals.average_cadence|floatformat:"-2" }} / {{ user_totals.maximum_cadence|floatformat:"-2" }} rpm</span>
        </div>

        <div class="userSummaryItem">
          <span class="summaryLabel">Heart Rate:</span>
          <span class="summaryField">{{ user_totals.average_bpm|floatformat:"-2" }} / {{ user_totals.maximum_bpm|floatformat:"-2" }} bpm</span>
        </div>

      </div>
      <div class="summaryGroup">

        <div class="userSummaryItem">
          <span class="summaryLabel">Average Speed:</span>
          <span class="summaryField">{{ user_totals.average_speed|kph_to_prefered_speed:user.get_profile.use_imperial }} {{user.get_profile.use_imperial|mph_or_kph_units}}</span>
        </div>
        <div class="userSummaryItem">
          <span class="summaryLabel">Max Speed:</span>
          <span class="summaryField">{{ user_totals.maximum_speed|kph_to_prefered_speed:user.get_profile.use_imperial }} {{user.get_profile.use_imperial|mph_or_kph_units}}</span>
        </div>
        <div class="userSummaryItem">
          <span class="summaryLabel">Calories:</span>
          <span class="summaryField">{{ user_totals.total_calories|floatformat:"-2" }} Cal</span>
        </div>
      </div>
    </div>
  </div>
<br/>
<h2>{{user.username}}'s tracks:</h2>
<div class="datatable">
  {% ifnotequal num_activities 0 %}
    {% include "activity_table.html" %}
  {% else %}
        <p>You haven't uploaded any activities.  Click the upload link to get started.</p>
  {% endifnotequal %}
</div>
{% endblock %}
